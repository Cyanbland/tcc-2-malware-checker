import os
import streamlit as st
from dotenv import load_dotenv

import cookies
import sidebar

if 'auth_status' not in st.session_state:
    st.session_state.auth_status = 'Not Authenticated'

# Main function to control the app flow
def main():
    load_dotenv()

    api_endpoint = os.getenv("API_ENDPOINT")
    cookies_password = os.getenv("COOKIES_PASSWORD")
    jwt_secret = os.getenv("JWT_SECRET")

    if not api_endpoint:
        print("API_ENDPOINT is not defined in the .env file.")
        return
    
    if not cookies_password:
        print("COOKIES_PASSWORD is not defined in the .env file.")
        return
    
    if not jwt_secret:
        print("JWT_SECRET is not defined in the .env file.")
        return
  

    st.header("Malcheck Platform")
    st.subheader("Your place for Malware Analysis")
    with st.expander("Avaiable analyses", expanded=True):
        st.markdown("- Multiple YARA Rules sources")
        st.markdown("- Fuzzy Hashing with SSDEEP")
        st.markdown("- File Import Fuzzy Hashing")
        st.markdown("- TODO: Traffic Analysis in VM")
        st.markdown("- TODO: Behavior Analysis in VM")


    st.write("Developed by Paulo Rubens de Moraes Leme JÃºnior")
    sidebar.sidebar()

main()
