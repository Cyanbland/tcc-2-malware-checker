import os
import streamlit as st
from streamlit_cookies_manager import EncryptedCookieManager

class Cookies:
    def __init__(self) -> None:
        self.cookies = EncryptedCookieManager(
            # This prefix will get added to all your cookie names.
            # This way you can run your app on Streamlit Cloud without cookie name clashes with other apps.
            prefix="malcheck/streamlit-cookies-manager/",
            # You should really setup a long COOKIES_PASSWORD secret if you're running on Streamlit Cloud.
            password=os.getenv("COOKIES_PASSWORD"),
        )
        if not self.cookies.ready():
            # Wait for the component to load and send us current cookies.
            st.stop()
        self.jwt_name = "jwt_token"

    def getJWTCookieValue(self):
        return self.cookies[self.jwt_name]

    def updateJWTCookie(self, value):
        self.cookies[self.jwt_name] = value
        self.cookies.save()

    def deleteJWTCookie(self):
        del self.cookies['jwt_token']
        self.cookies.save()
    

cookie_manager = Cookies()