import { Injectable } from "@nestjs/common";
import axios, { AxiosResponse } from "axios";

@Injectable()
export class MalwareBazaar {
    constructor() {}

    private MALWAREBAZAAR_URL = "https://mb-api.abuse.ch/api/v1/"

    async queryImphash(impHash: string) {
        const body = new FormData()
        body.append("query", "get_imphash")
        body.append("imphash", impHash)

        try {
            const response: AxiosResponse = await axios.post(this.MALWAREBAZAAR_URL, body);

            return response.data;

        } catch (error) {
            console.error("Error querying imphash:", error);
            throw error; 
        }
    }
}