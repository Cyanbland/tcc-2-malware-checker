import { Injectable } from "@nestjs/common"
import axios, { AxiosResponse } from "axios"

@Injectable()
export class UrlHaus {
    constructor() {}

    private URLHAUS_URL = "https://urlhaus-api.abuse.ch/v1/url/"

    async queryUrl(url: string) {
        const body = new FormData()
        body.append("url", url)

        try {
            const response: AxiosResponse = await axios.post(this.URLHAUS_URL, body)

            return response.data

        } catch (error) {
            console.error("Error querying URL:", error)
            throw error 
        }
    }
}