import { Controller, Get, HttpCode, HttpStatus, Post, UseGuards } from '@nestjs/common';
import { JwtGuard } from '../auth/guard';
import { GetUser } from '../auth/decorator';
import { ConfigurationService } from './configuration.service';

@Controller('configuration')
@UseGuards(JwtGuard)
export class ConfigurationController {
    constructor(private configurationService: ConfigurationService) {}
    
    @Get('my-config')
    getMyConfig(@GetUser('email') email: string) {
        return this.configurationService.getMyConfig(email)
    }

    @Post('toggle-configured-yara')
    @HttpCode(HttpStatus.OK)
    toggleConfiguredYara(@GetUser('email') email: string) {
        return this.configurationService.toggleYaraAnalysis(email)
    }

    @Post('toggle-configured-fuzzy-hashing')
    @HttpCode(HttpStatus.OK)
    toggleConfiguredFuzzyHashing(@GetUser('email') email: string) {
        return this.configurationService.toggleFuzzyHashingAnalysis(email)
    }

    @Post('toggle-configured-import-hashing')
    @HttpCode(HttpStatus.OK)
    toggleConfiguredImportHashing(@GetUser('email') email: string) {
        return this.configurationService.toggleImportHashingAnalysis(email)
    }

}
