import pefile

def main():
    pass

def import_hashing(file_path: str):
    try:
        file = pefile.PE(file_path)
        print(file.DIRECTORY_ENTRY_IMPORT)
        for entry in file.DIRECTORY_ENTRY_IMPORT:
            print("DLL Name:", entry.dll.decode())

        # Iterate over the imported functions
            for imp in entry.imports:
                if imp.name:
                    print("\t", imp.name.decode(), hex(imp.address))
                else:
                    # Some imports might not have a name
                    print("\tOrdinal:", imp.ordinal)
    
    except pefile.PEFormatError as err:
        print("File is not a Portable Executable")

if __name__ == '__main__':
    import_hashing("../ssdeep-2.14.1/fuzzy.dll")